[ { "title": "WRCCDC 2023 Aftermath: DFIR, and BlueTeamCon", "url": "/posts/WRCCDC-BTC-2023/", "categories": "", "tags": "WRCCDC, CCDC, DFIR, Talk", "date": "2023-09-05 19:45:00 -0700", "snippet": "IntroductionThis year, @Bluescreenofwin and I, were able to do some DFIR on boxes after this year’s regional round for WRCCDC and give a presentation at BlueTeamCon 2023, where we discussed the trends seen throughout the competition. Most of it can be boiled down into several industry basics that not only do teams not follow, but a surprising amount of large corporations. The slides for the talk, alongside other resources, are linked at the bottom of this post.What is a CCDC?CCDC is the Collegiate Cyber Defense Competition. This competition drops a team of eight students into a production environment with two goals: Keep services up for customers, and survive against a red team that didn’t exactly sign a Rules of Engagement. There are nine regions across the United States in total - and alongside a host of many volunteers, Bluescreen and I help to run the Western Region as part of the Operations Team, aka Black Team.The environment we create does not have much in the way to security tooling to emulate an immature company. We do not give the students any AV/EDR tooling, and we do not use the latest and greatest security recommendations. These boxes are purposely a mix of EOL, up-to-date(ish) hosts, and one or two oddballs thrown in for fun. This year, we did give the teams a SIEM(the one built into Kali Purple) to leverage should they want to. We’ll touch on this specific point later on.During the competition, students are also expected to work with both clientele and upper management as part of their daily business function. This can be anything from security briefings, to tasking given by shareholders(eg set up new software), or simple madhouse fun of spouting random stuff at the teams in order to confuse them.The overarching goal of this competition is to overstimulate the student teams. It seems rather asinine on the surface, but does hold merit when teaching students how to multi-task and learn new things on the fly. Additionally, CCDC is not a competition focused solely on defense or incident response. It is a grouping of many related business tasks that a student might often see when they are working in a Full-Time position. A map of all the regions in the US Why This Talk?This talk was born out of a harebrained idea and a want to go to touch the Bean in Chicago. Whilst the former goal reached completion, the latter did not.In all honesty, curiosity drove us to try this. In my dayjob as an IR consultant, I get to see a swathe of new environments almost daily, and the large gaps of maturity between all of them. As a Senior Systems Engineer, Bluescreens’ job is to harden his environment against the latest threats. Both of us see the latest trends in security, but do the students see them, and use them during the competition?Most classes do not cover the latest on-goings in security- any of this knowledge is most likely gleaned from external sources, be it current or past internships, other competitions, news, or the social network. We were curious to see which teams were able to take advantage of the resources they have, and how they applied it to the competition.Our MethodologyGiven the relatively short time between the CFP approval(), the actual regional competition that we took our data from, and the balance between $dayjob and this, we elected to pick two critical systems from the student environment- Bluecheese and Oaxaca. Outside of being lovely cheeses, these boxes represented the primary Domain Controller and the primary company website box in each student environment respectively. The (Mostly) Full Scope for this Year's Regionals From here, we chose six snapshots throughout the two-day length of the competition - Four on Day One, and Two on Day Two. In theory, the first day would be Red Team worming their way through the environment and establishing persistence, while also causing some havoc. From here, we used KAPE and CyLR to collect triage data from all the snapshots, processed them using Log2Timeline/Plaso, and then threw them into a Timesketch instance.Of note, we have to thank Ryan Chapman and the SANS FOR528 course, as we used their method of parsing the triage data(using MFTEcmd for the MFT instead of L2Ts own parser) and streamlining it into a single plaso file. I am also forced to admit that I should have listened to Ryan in the first place, and owe him an ice cold beer for his help.From here, it was a simple matter of wishing we remembered an ounce of OpenSearch’s query language, and time.What we Found outRed TeamK.I.S.S was the motto of our red team. ZeroLogin EternalBlue was the primary method of Windows Initial Access, and for Linux, simple Brute forcing and abuse of default credentials that the Red Team found. Persistence was primarily OpenSSH and malicious accounts in the directory. Overall, the usage of default creds accounted for 56% of the Red Teams initial access, similar to the usage of insecure passwords in the real world. Our Red Team did not employ any amazingly advanced tactics outside of the use of Cobalt Strike and Metasploit.Blue TeamStudents, on the other hand, did not often follow basic practices during the competition. Only one team out of the group of eight competing consistently rotated the default credentials throughout the competition and after box resets. Box Resets allow teams to reset a box to the start of the competition state if they end up getting destroyed by either the blue teamers themselves or red team. The consequence of this is they lose all hardening and credential rotations that may have taken place. Most of the teams relied heavily on box resets, and consequently kept on getting breached by Red Team due to the lack of credential rotations. Only our top two teams enumerated the Active Directory domain for malicious users and infrastructure, and only our top team employed the usage of Sysmon for extended logging. Both these top two teams however, did use a SIEM of their choosing. NONE of the teams leveraged the Kali Purple SIEM that was handed to them. These top two teams were also at the top of their class in both defense and incident response, keeping and clawing back the most points compared to the other teamsWhat Students should learnThis blog post is not meant to simply mock the teams that did not do as well. Our goal in CCDC is to teach students by giving them experience that no class or extracurricular activity(that we know of) replicates. Overall, from the ops team perspective, we would like to see all students do the basics of security, between credential rotation, environment enumeration, and logging. This is however, far easier said than done given the generated chaos of the competition. Those three steps would make the Red Team step up their game pretty quickly, and from thereon students can build to more advanced skills such as on-the-fly triage of popped systems.What Ops needs to do betterThe Operations team does share some burden in the performance of Blue Teams. Consistently, we are asked to give more resources and trainings on how to succeed in the competition, and each year we are unable to fully fufill this goal. Additionally, our environments, while whimsical and cobbled together, are not entirely accurate of what we see in industry today. While we do see our fair share of environments that are held together with duct tape and dreams, we also see our fair share of environments that are monitored extensively and manned by experienced analysts and responders who are able to respond to a pin dropping. Overall, we need to work on having less fun with the boxes we create, and work moreso on resilliences of systems and services - not everything can be an 8 year old version of Wordpress.We also ended up “Black Teaming” ourselves- as the systems we put out did not meet our own basic requirements! Every system must have a SSH key or other emergency backdoor that is offlimits to all teams but us for purposes of troubleshooting and assisting teams/the competition at large. This was not fully verified, and tripled the time it took to create triage packages of all these systems, as well as causing issues during competition.Future PlansBlack Team is always doing our best to improve the competition year after year, and keep things inline with the industry as much as we can. In our attempts to do this, competitors, and those who may access this data in the future, will see some key changes.Primarily, we plan to once again give teams a SIEM, be it Kali Purple, Greylog, Wazuh, or something else. Additionally, all of our systems should be coming with some extended logging tooling and response tooling. This would primarily be Sysmon alongside Velociraptor on all the systems. Our hopes is that this will enable more teams to do more Incident Response during the competition, or at the very least have a closer eye on their environment as the competition progresses.ResourcesWe hope to turn this DFIR project into a yearly item, both the triage data and perhaps even a report. For this year, we are hosting(for the forseeable future) the triage data collected from these systems on our archive server. Additionally, the slides given to attendees at BlueTeamCon 2023 are linked on my GitHub below.A huge thank you to a multitude of people- from the volunteers that help run not only WRCCDC but the other CCDC regions, to the students who find enjoyment in the competition we make, to the wonderful organizers of BlueTeamCon. A formal request from me and Blue to the conference organizers… can we have Pequods catered?Triage Data:https://dfir.wrccdc.org/dfir/Presentation:https://github.com/Turb0Yoda/Presentations/blob/master/BTC-2023.pptxWRCCDC Twitter &amp; LinkedIn:https://www.linkedin.com/company/wrccdc/https://twitter.com/wrccdcBluescreenofwin’s Twitter:https://twitter.com/bluescreenofwin" }, { "title": "Forensics Laboratory - Frameworks, Attestations and Accreditations", "url": "/posts/forensic-laboratory-the-building-blocks-frameworks-attestations-and-accreditations/", "categories": "", "tags": "laboratory, audit, attestation, accreditation, Framework", "date": "2023-02-15 20:45:00 -0800", "snippet": "IntroductionHappy New Years! To kick the New Year off, we’re gonna talk about probably the worst part, in my opinion, of running one of these bad boys- AUDITS. I will try to fake as much enthusiasm as I can, but I know all too well how boring this part is. This is not intended to be any sort of replacement or guide to set up your environment to the standards mentioned within, but to show you the different setups and overlaps that occur in this mire.Why do we have to deal with this crap?Outside of the general goodness of keeping up secure and sanitary measures within your environment, and having a large document detailing everything, is that some of your customers may actually have a requirement for all their vendors to have a certain accreditation. Alongside this, it serves as a good badge of faith for customers since anyone looking from the outside-in will know that a minimum level of items happens in order to make sure all data/information remains safe. It absolutely will be a key if they compare your services with another firm that is not accredited. If you deal with GDPR or HIPAA, it is doubly more-so important to be compliant.FrameworksFrameworks are, once boiled down, a long bloody list of checkboxes that you have to tick in order to get compliance/Accreditations. In order to get Accreditations, all of the controls listed in the framework(s) have to be met. Just because you meet the requirements of the framework do not automagically get you the accreditation either - an external firm or agency must audit you to ensure they are met.The one upside is that a lot of the framework’s specifications are similar or interrelated such that you can set your standards to whichever is stricter, and then remain compliant for all frameworks you observe.ISO 27001Accompanying the granddaddy of them all is also ISO 17025, which is aimed specifically at forensic laboratories. Unfortunately, it is the forgotten cousin, so it often does not get mentioned. Any organization can follow this framework and get its respective Accreditation.ISO 27002 also tends to fall hand-in-hand with 27001. Whereas ISO 27001 is focused on managing and protecting sensitive information, ISO 27002 is a set of practices for Information Security Management. ISO 27001 comes with accreditation, but ISO 27002 does not.NIST 800-53For Government Agencies, Contractors and… Acquaintances, NIST 800-53 exists. It’s essentially a superset of the aforementioned ISO standards. It also comes with its own accreditation, and much more stress.FBI CJISAnd for the MacDaddy of stress, we have the FBI CJIS framework and attestation. It’s essentially all of the above wrapped up, with even more controls, and one lovely consequence for failure. Being CJIS Accredited means you, and vetted individuals, are able to handle criminal evidence. This is primarily for Government Agencies, but private firms can get this attestation and audit done over a 3-year cycle if they want to work with agencies and local LEOs. The consequence of mishandling evidence, however, results in a nice trip to Federal Prison.Attestations and AccreditationsThese are the nice shiny badges you get for successfully remaining in compliance with a framework! ISO, NIST, and CJIS all have these bundled with the framework if the organization wishes to pursue it, however there are two Accreditations I have not mentioned yet.FEDRAMPAWS called, and along with the seven-figure bill you’ve racked up with totally legitimate mining programs, it also came with its own Attestation. It is essentially a NIST-type deal, but aimed towards anything that resides or touches the cloud. If you are looking to work with Agencies and leverage the cloud, then FEDRAMP is a must.CMMCCMMC is a new program on the scene, kicked off in 2020 by the DoD. As expected, it is also for Federal Agencies and contractors, and there are different levels of compliance requirements based on the type of data you handle. It’s primarily to safeguard Controlled Unclassified Information, or CUI. CUI was also originally called For Official Use Only, or FOUO, to further add to the confusion. I suppose it also makes more sense grammatically…OutroThis is painful to write. INAL or an auditor, so please take the above with a grain of salt. There may be some nuances in phrasing that I may have missed." }, { "title": "Forensics Laboratory - Forensic Software", "url": "/posts/forensic-laboratory-the-building-blocks-software/", "categories": "", "tags": "laboratory, infrastructure, software", "date": "2022-11-24 18:42:00 -0800", "snippet": "IntroductionIf I’ve seen anything close to divisive in the industry, it’s the software forensicators use in their day-to-day work. A lot of tools come and go, and a lot remain giants in the field. I don’t intend this as an end-all-be-all list of tools you’ll see in a lab, but maybe more of the more popular/often used tools, closed-source or open-source, extremely pricey or free-99. At the end of the day, I like to describe most of these tools as a different way to do the same thing. If you’re trying to pull out the NTUSER.DAT file from an image or triage data, you can just as easily do that with X-WAYS or EnCase or FTKi or Autopsy.I’ll do my best to keep this specific post updated with any more tools I find(primarily the specialized tooling section). Additionally, some of these tools can function well in multiple categories. I’ve put them in what I believe their main focus is, but I will note down if they’re able to carry out other tasks- but without further ado…Traditional Dead Disk Tooling Autopsy &amp; The Sleuth Kit Autopsy, and by extension The Sleuth Kit, holds a very special place in my heart. This is the tool I used to teach workshops when I was in college, and instead of all of the tools in this section, which are paid, Autopsy(TSK) is free. I can’t thank the people enough behind this project(first and foremost in my mind is Dr. Brian Carrier(Writing this post is the first time I learned he had a doctorate, I shouldn’t be surprised yet I am) and the Basis Tech team) in keeping this software alive. If you are in a position where you do not have access to the paid tools, you HAVE to have Autopsy in your arsenal. Even with the paid tools, we still keep an updated copy of Autopsy ready to go. It also deserves mention that Autopsy is the sum of both itself(the GUI) and the underlying “The Sleuth Kit”. Just about everyone that I know, including me, simply calls this tool Autopsy, but you can run TSK in just the terminal without the GUI should you wish. AXIOM I’ve often jokingly called MAGNET’s AXIOM the iOS of forensics - simply click on your image, and the artifacts you want, and go grab a bite to eat. However belittling that sounds, it truly is still a testament to what MAGNET has brought to the table with its product. It may not be as granular as something like X-Ways, but makes up for it in the simpleness of UI and the “quick wins” I often find myself falling back to with it. Additionally, AXIOM supports MacOS, mobile, automotive, and some cloud platforms, making it an extremely unique swiss army knife. EnCase The giant in the field, EnCase has been around longer than I’ve known how to use a computer. I do think it seems to have fallen out of favor over the years, but it still remains a popular tool used by many. FTK(and it’s younger brother FTK Imager) FTK is also another giant in the field, but has also suffered a similar fate as EnCase. It is still seen in the field, and it’s younger and free brother, FTK Imager, definitely deserves a shout-out. In it’s own simplicity, FTKi is extremely useful not only for basic imaging of disks but for quickly pulling singular artifacts out or even basic file recovery. X-Ways Forensic I had never heard of X-Ways until relatively recently, only a few years ago. Since then, it has become the one tool that seemingly every shop uses in my eyes. It is both my greatest nightmare and greatest asset. Brett Shavers offers a great guide for XWF, I highly reccomend grabbing it if you find yourself working with XWF. XWF also handles MacOS filesystems, but I know little of that since MacOS scares me. Mobile Forensics Cellebrite Infamous or famous, Cellebrite has carved its name into stone as far as mobile forensics goes. With the Acquisition of BlackBag Technologies, Cellebrite is also now a giant in the MacOS Forensics arena, and is the defacto name for both Mobile and MacOS forensics. Belkasoft Belkasoft is another firm that aims to be more of an AXIOM-like product, focusing on mobile, cloud, and computer forensics. Elcomsoft Elcomsoft is a Russian-based firm that produces forensic software… for many reasons, I also have no experience with this software. MASB XRY XRY is also another large name in the industry, but from what I have seen, they primarily target Law Enforcement as their clientele. They have a suite of tools aimed for mobile crime-scene forensics. Oxygen Forensics Oxygen is another firm that specializes in mobile forensics. I personally have 0 experience with their tooling, so I can’t speak to anything about it other than it exists. Automotive Forensics*Disclaimer: I haven’t touched automotive forensics, so I will not be doing much other than listing names here. Berla EnVista Teel Tech Specialized Tooling AccessData Registry Viewer Not updated anymore, but a useful tool for viewing Registry Hives quickly. AnalyzeMFT A Python tool for parsing out MFT entries. Arsenal Recon Arsenal provides a range of tools, however, it’s image mounting tool is extremely unique in that you can make a virtual machine based off of evidence without altering the original .e01/vmdk/mounted drive. This has absolutely saved our bacon at a past job when the physical domain controller fried and so too did our backup box. The other tools they offer, such as their registry parsing tools, are similarly great. BMC-Tools RDP leaves behind a trail of bitmap images that an examiner can sometimes use to put together the RDP session of what was active at a time. While rarely used, sometimes one can get great results and solve an important piece of the puzzle with this tool. CAINE A similar tool to SIFT, although it does not get updated as nearly as much from my understanding. It can still be useful to keep around. CyberChef CyberChef, the google translate of the InfoSec world. Digital Detective Dcode A free tool for identifying and decoding different timestamp formats. EZTools Yet another invaluable set of tools, Eric Zimmerman’s toolset encompasses a wide gamut of artifacts, primarily/all for Windows forensics. NirSoft Tools Another set of tools that, while not immediately geared towards forensics, can easily be used for such. OSFMount A tool for mounting images as well as making RAMDisks, should you casually have a few hundred extra gigabytes of RAM laying around. RegRipper Registry Hives tremble in front of the Ripper. SIFT A bootable ISO that has a load of forensic tools. SANS is an invaluable resource, and this is just one of the many they offer. Volatility The memory forensics tool. Yes, the tool. Notably, AXIOM uses Volatility as one of it’s built in tools when doing it’s automated analysis. This low effort post brought to you by fear of Thanksgiving Dinner arguments. Happy Thanksgiving!" }, { "title": "Forensics Laboratory - Networking Sucks", "url": "/posts/forensic-laboratory-the-building-blocks-networking-sucks/", "categories": "", "tags": "laboratory, infrastructure, networking", "date": "2022-10-28 19:27:00 -0700", "snippet": "IntroductionI despise networking with a passion. Not because it’s overtly complicated.. which it is. It’s because I have the absolute worst luck with hardware and making simple configurations work, like when I bricked a Juniper switch by setting a port to trunk. I don’t know how it happened or why, but I do know it’s what led to that being tossed in the bin.Nevertheless, this cursed subject is indeed a requirement to build out a proper laboratory. This post has a list of assumptions about your network, in that your organization already has authentication, VPNs/ZeroTrust, Access Management, AD/DNS, etc all set up. I’ll leave covering all that up to the people who know and love networking and will focus primarily on the little nugget that is the lab. Additionally, I won’t go too far into configurations of different aspects of networking, primarily due to how different these items can vary from vendor to vendor at all levels of this realm… and because my knowledge doesn’t extend that deeply into said realm.Hardware ConsiderationsThis section isn’t a hardware buying guide insomuch as what you may want to consider when purchasing equipment. The number one thing that comes to mind outside of vendor preferences is throughput and longevity/upgradeability.I strongly suggest that someone who is building out a forensics lab in this day push their organization to, at a minimum, get hardware that is capable of 10Gbps for data transfer. The time it takes to transfer images between machines and hot/cold storage will be drastically shortened assuming that the destination and/or source are not a single spinning drive. Additionally, if one is getting into a HCI setup, then greater than 10Gbps is ideal. Offhand companies like iXSystems push to have a 40GB connection to the core network for larger SAN devices. This doesn’t mean you shouldn’t get a standard 1Gbit switch for management or other items that may only be limited to 1GBit, eg a dongle server. Additionally, some switches, such as Cisco Nexus gear, come with empty/filled slots for expansion ports. If you can’t get the buy-in now for a full-fat 10GB or greater switch, these may be worth looking into.Isolation, Authentication, and AccessAs per the tradition of a secure location, only authorized people can get in. As such, the lab network should also be similarly locked down with VPNs, captive portals, etc. Generally speaking, each step of authentication will have 2FA from what I have seen, be it through Duo, a RSA token, or another method. Unfortunately, my lack of knowledge in this specific tooling is pretty lackluster outside of product names. I will say that from what I have seen, initial authentication can be done via the corporate SSO, and then inside-lab-network authentication can be handled with either a separate domain or the corporate domain depending on what is wanted.Multiple VLANsIf you’re extremely lazy like me, the idea of a flat network for this area sounds amazing. However, it’s not the most “secure”, and it does get annoying when you have different categories of devices to manage. At bare minimum, there should be at least two VLANs, one for normal workstations, and one for management. If we take a trip down memory lane real fast and look at my previous post on hardware, I mentioned making sure that each machine has IPMI/equivalent. Speaking from personal experience, having IPMI is a lifesaver, and keeping it separate from normal workstation addresses helps to not only make sure no one accesses it accidentally/maliciously but to make your network diagrams nicer :). In all seriousness, it also is nice to ensure that only lab administrators/managers have access to this VLAN.If you are lucky enough to have a hypervisor/HCI environment in your lab, you will also most likely want a network just for the storage layer. Making a VLAN for the VMs/Containers that will run on that infrastructure will bring up the total count to a nice even number of four. At the end of the day though, you can get by with two if you are careful about what goes where. A quick and dirty reference list is below.Example Network Structure: - 172.16.16.x/24 - Management VLAN - 172.16.32.x/24 - Forensic Workstation VLAN ——————————————— - 172.16.64.x/24 - HCI Storage Layer VLAN - 172.16.96.x/24 - HCI VM VLANConclusionThis post is really short since the networking side of the house is something I avoid, and don’t have enough knowledge to flesh this out. I haven’t figured out what the next post will be on yet, probably the particulars of handling evidence and such… we’ll see." }, { "title": "Forensics Laboratory - The Building Blocks - Hardware Pt. 2", "url": "/posts/forensic-laboratory-the-building-blocks-hardware-pt2/", "categories": "", "tags": "laboratory, infrastructure, hardware", "date": "2022-08-22 21:20:00 -0700", "snippet": "IntroductionThis is the second part of the blog post about the hardware needed in a forensics lab. This will all be about the smaller gear and adapters and other miscellaneous stuff you might need. By no means is this comprehensive, partially because my memory is garbage, partially because you will need different gear for different things. A lab specializing in or providing vehicle forensic services will need special gear that I won’t be putting down in this article.Write BlockersWrite Blockers(AKA Forensic Bridges) are exactly what they say on the tin - they prevent a computer from writing to the media being imaged or analyzed. This is primarily to ensure the evidence is not altered. There are both software and hardware write blockers, although the latter is always preferred.NIST is lovely enough to have done testing on both hardware write blockers and software write blockers. This is by no means comprehensive, especially the software list, but it’s always good to stick to something on that list in case your methodology is questioned by someone like legal counsel, or if you have to give testimony in court and that is brought up.I won’t touch on software write-blockers as much as they are not nearly as popular/used. Cellebrite offers softblock, CAINE and SIFT both offer similar functionality in included tools, as well as stuff like ForensicSoft. Realistically though, the chances of having to use these are minuscule.Portable/Stand-aloneAs far as hardware write-blockers, there are only two options that I’ve seen ever used or offered widely- Tableau and Wiebetech(CRU). They are identical in functionality and serve the same purpose. Both also offer variants of the docks(coloured bright yellow so you don’t miss it) that can be used to write as well if the physical dipswitches or software is adjusted.Primarily the only device types you will be imaging in this age are either SATA or PCIe. Form factors will vary, but I will cover that in the Adapters section. Tableau and Wiebetech both offer options for this:   Tableau T35u Tableau TK7u Wiebetech FUDv6 Wiebetech NVMe WriteBlocker Type SATA/IDE PCIe(NVMe) SATA/IDE PCIe(NVMe) Price 389$ USD 475$ USD 400$ USD 499$ USD Prices sourced from either FCI or Wiebetech Direct  My recommendation is to spring for Tableau gear if you can do it, as it’s way more widely used, otherwise, Wiebetech will work just fine, unless you’re cursed like me with stuff breaking randomly - the Wiebetech gear has been finicky for me, whereas the Tableau gear has simply “just worked”.As far as the PCIe gear, you may need additional adapters, but I’ll address that in the Adapters section.5.25” BayBoth companies offer the same product, but one that mounts in a 5.25” bay. Tableau’s is the T356789iu at a nice 1,099$ USD.Wiebetech has the Forensic LabDock U5 at a much nicer 399$ USD.The Tableau unit is much more versatile, and that wins hands-down due to that, but it also comes at ~2x the cost of the Wiebetech. Again, I highly recommend springing for the Tableau gear.Imaging StationsI covered this in the previous article about forensic hardware, but they merit a duplicate section here. Companies such as Tableau and Logicube make these little devices that are solely built for imaging drives. They take up a lot less space than full-on workstations, and can quickly output to either staging drives or network shares. However, I would consider these devices more of a splurge or non-essential if you are fine with having a separate write-blocker as mentioned above. They make great sense if you are a high throughput shop and need to be imaging items constantly without having to mess with a physical system and kicking users off/messing with mounted drives. Once again, I like the Logicube because of the dual 10GB NICs. Spinning rust won’t saturate it but PCIe/NVMe drives will surpass 1GBit I believe.Mobile AnalysisMobile Analysis is unique in that you cannot use a write blocker due to how the collection tools operate. If you do need hardware outside of your chosen tool (Cellebrite, Paraben, Oxygen, etc) and the required cables for the device, Cellebrite offers the Touch2 which is essentially just a ruggedized tablet preloaded with UFED. Paraben also has a similar solution.However, you will need a faraday bag or box to prevent signals from reaching the phone. Airplane mode/similar alone should not be trusted. Bags/boxes should be used for both transport and storage of the evidence. I like this kit from Silicon Forensics since it has multiple bags as well as a battery bank if the device must remain on.I cannot stress how important it is to have at least one of every possible cable or adapter you think you might need. There may be a day where you have to imagine some old external that runs off of firewire or some IDE/PATA hard drive, and not everyone is lucky enough to have a lab next to both a Microcenter, Best Buy, and (when it was still alive anyways) Fry’s. Both Cellebrite and Tableau make kits that are essentially just bags/cases full of neatly organized cables. They do come at a premium but are nice if you just want “everything” from a reputable source.You can also just go to Amazon and buy a load of adapters or cables that you think you might need. I will stress that it is extremely important to stay with a good brand and test them with test media before using it on evidence. I once had a drive go up in smoke due to a dodgy adapter- the only thing that saved me was using test media before going to the evidence itself.I won’t make a list of “essentials” here, since not only will that vary from shop to shop, depending on what you offer, but also since the write blockers will come with their own set of cables, and that very well may be exactly what you need/require and nothing more. But again, it’s better to be safe than sorry and on a time crunch ordering a load of items from Amazon and hoping they arrive in time and undamaged.As the last item, I really, *really** like this IODD multiple ISO drive cage. It may be more of a lab manager/tech item, but it’s extremely useful to be able to boot off a plethora of ISOs from one drive. They have a few different variants, I simply linked the one I have. Do note that you need to supply a drive, I’ve tossed in a spare 128GB SSD laying around and filled it with various Windows, Linux, and troubleshooting/testing ISOs. It’s saved me more than one time and frees one up from carrying 20 unlabeled random USBs around.OutroI think that mostly covers it for this section. I may make edits/additions to the articles which will be reflected in a little changelog below. As of right now, nothing else comes to mind :)." }, { "title": "Forensics Laboratory - The Building Blocks - Hardware Pt. 1", "url": "/posts/forensic-laboratory-the-building-blocks-hardware/", "categories": "", "tags": "laboratory, infrastructure, hardware", "date": "2022-08-17 21:00:00 -0700", "snippet": "IntroductionHiya!This is part two in my little series about building a forensics lab from the ground up… literally. This post will be going over the basic hardware needed to run a lab, covering all aspects from machines to write blockers to the network. In another post, I hope to explore Hyper-Converged Infrastructure for Forensic Analysis, so this will be focused on a lab that does not have a relatively high volume of incoming evidence or work in general. I broke this post up into two parts, the second part should be coming out sometime soon.Physical MachinesForensic TowersThe first step is to have a bank account with a large amount of money. I wish this was a joke, but unfortunately, tailor-built forensic workstations are extremely pricey. Not only should the hardware be top of the line and beefy, but items like drive cages, DVD/Blu-Ray/CD drives, and even write blockers are often shoved into these chassis. For example, a base configuration SiForce Lightning X comes out to a lovely 10,695.00 USD before tax, which isn’t an easy pill to swallow. Remember what I said about shoved chock-full of gear? This is how SciForce rolls. For Reference, that system does have 40 threads, 192GB of RAM, and several storage areas for casework (examples in parentheses): 500GB NVMe Boot 1TB NVMe Temp Drive (used for e01s) 8 1TB SSDs in a RAID config (used for software to do processing on) 6TB Spinning rustThe main benefit of buying from a company like SiForce, aside from these machines only needing a copy of your choice of forensic software(s), is the warranty with the machines. Downtime in an environment like this is unwanted, to say the least. There is little hassle for the lab manager or person handling the hardware while the warranty is active, versus building a system yourself and screaming in pain when a motherboard dies.Jokes aside, that system is extremely beefy but is most likely absolute overkill for most outfits. When building these systems, there is a finite number of resources available per user running process/analysis on an image. Tools like MAGNET AXIOM will chew up all your RAM with no regard to anything else, and while this can be limited in the AXIOM profile setup, you still are limited to say, 2-3 AXIOM PROCESS tasks running, at least in my experience. SiForce, alongside an extensive range of other boutique builders such as Sumuri and Digital Intelligence offers comparable/competing workstations. A large portion of deciding what system specifications and the number of systems depends both on the volume of evidence and the number of analysts actively working on disk images.In my experience, limiting say, AXIOM to 32GB of RAM and 12-20 threads seems to be the best balance of performance and system usage - you may find other balances with other tools such as X-Ways or EnCase.If you do take the DIY route, or go with a non-forensic workstation boutique builder, I do think there should be some strict requirements in mind: A good amount of processor cores and RAM Make no mistake, your analysis software will chew through everything it’s given and then some. It’s always better to oversize than to have just enough. Keep in mind that Windows also needs RAM and CPU and running too many tasks (or cough AXIOM cough) will lock your system up. You don’t need Xeon Platinum’s or the top tier Threadripper CPUs and 1TB of RAM per system, but I baseline ~20C/40T and 128GB of RAM to allow multiple analysts to work on one system if necessary. ECC RAM Every step to prevent data contamination must be taken, ECC is just one step in the process Server/Workstation boards with features such as IPMI This will save you a lot of time if a machine needs to be remotely rebooted/troubleshot. It also allows even more information to be sent to a remote logging setup such as Zabbix, which will help alert the lab manager/caretakers if any critical issues arise. Additionally, not only do these boards can house large core count processors and a large amount of RAM, but they also come with many PCI-E slots, meaning adding in items such as extra graphics cards, more LAN controllers, or more RAID cards are extremely easy. This is, of course, a bit of a generalization in terms of features, but it does tend to be the norm in this class of motherboards. I highly recommend ensuring your systems have room for any possible expansion. Multiple RAID controllers This is more about being able to have separate areas for data, but also to ensure there are some redundancies if a drive does go out. I would only recommend using RAID 10, RAID 50, or a similar setup to ensure data isn’t lost if a drive dies. I can imagine seeing people set up a RAID 0 array for temporary files, however, the only way I could plausibly recommend this is if the only data stored on this drive are image files, and there are no less than three copies of the data elsewhere in case there was an incident with a drive dying. Again, do not recommend running RAID 0 for that level of production. Loads of spare 5.25” Bays 5.25” bays, while uncommon in this age, are extremely useful for built-in write blockers, docking bays, etc. I wouldn’t build a system without at least a few of these. 10GB LAN This is more of a future-proofing step and can also be added in with an add-on card, but 10GB LAN to transfer case files is a godsend. MacOSIf you thought you were done spending the big bucks, you were wrong. While tools such as AXIOM and X-Ways can parse out MacOS systems, sometimes it is just best to have a dedicated Mac system for processing and analysis, especially with the advent of the new M1/M2 chips from Apple. Unfortunately, I have had no experience with forensically imaging/analyzing the M1/M2 gear, and only a small amount with normal MacOS.So, this section is pretty short and sweet. Offhand, I am not entirely sure if software such as Sumuri or Cellebrite will run on M1/M2 gear, but it will run on Intel-based Macs, and will still be able to analyze M1/M2 gear. My current recommendation is to buy either a decently specced Mac Pro (~9,000USD for a system with a 16c/32t processor and 96GB of RAM), or then a decently specced Mac Mini (much cheaper!). In all honesty, unless you happen to have a lot of analysis that needs native MacOS, I would stick with the Mac Mini and a 10GB NIC to host your data elsewhere, as the largest amount of storage on a Mac Mini is 2TB (from this old link on Apple’s website).Mobile Workstations and Jump kitsNow let’s say you get a call from your boss, and suddenly, you find yourself with a plane ticket for a flight that leaves in 4 hours, and you need to somehow pack all your gear into a neat little case for on-site imaging and analysis. Well fear not, but there are a few options for this!For on-the-go imaging/processing/analysis, Silicon Forensics offers the cute little Nano, and Digital Intelligence offers the also cute little μFRED. These little suckers are a full forensic workstation with a built-in write blocker. You have the choice to have them come with a pelican case and other extra goodies. We bundled ours with a portable monitor and mouse/keyboard setup - all that is needed is a power source and you have a ready-to-go workstation. The main downside to this solution is that it’s extremely bulky and won’t really fit in a carry-on section. Nano μFRED So, for those of you who are like me and can’t carry anything without breaking it, or simply don’t have more luggage space, both companies offer “forensic laptops”. These are nothing more than extremely beefy gaming laptops/workstation laptops(SiForce’s looks eerily like an Alienware to me). The main benefit of these (other than having RGB for better performance :)) is that they’re much smaller but can pack up to a desktop processor depending on the specific laptop, such as this Sager, which packs up to a desktop Intel i9 and 128GB of RAM. I would really hesitate to call this a laptop, more of a small desktop with a built in UPS since that battery won’t last if it must process items. This, combined with a stand-alone write-blocker (I’ll get to these in a later section), will be able to do what those specialized little boxes can do.But wait, there’s more! In the off chance that you only need to image a device or three, you can also use a portable imager. This is an alternative to the aforementioned solutions- much more compact, but also a uni-tasker, something I’m sure Alton Brown won’t approve of. These devices can also have their own place in the lab as a dedicated imaging station that does not take up valuable seat space on forensic workstations. Companies such as Tableau and Logicube make such devices. The Logicube unit is especially nice to have as a dedicated in-lab imaging station as it has dual 10GB NICs, which, while may not get close to saturated with spinning rust, will help if you are imaging NVMe devices.Regardless of what choice you choose, it’s always good to keep evidence bags, chains of custody, stickies, etc. to correctly store evidence. Another good practice is to have a dedicated phone and/or camera just to take photos of evidence - this should all be well-known general practice regardless.UPSNo, not the shipping company, but Uninterruptible Power Supplies, or UPSs, are critical to making sure that not only does the machine imaging or running analysis tasks power off during a brownout or blackout but to make sure you have time to safely shut off and save work. There are three main types of UPSs; double conversion units, line-interactive, and standby UPS. Those are ordered in(my opinion) best to not best to have. Having one is better than having none! Additionally, you can also choose between a pure sine wave and a simulated sine wave. I highly recommend the former as some power supplies will not be happy with a simulated sine wave, and may power off if a switch between mains power and battery power occurs.Double ConversionDouble Conversion units are neat in that, in layman’s terms, the gear hooked up runs off the battery, while the power simply keeps that battery charged. In the event of a brownout or blackout, there is no faltering in voltage or anything as the battery is the source of power. These units are more inefficient and generally only seen in rackmount varieties, but if you can get them, I highly recommend them.Line InteractiveLine Interactive units are much more common. These units power everything off of the mains’ power, but in the event of a blackout or brownout, they will switch to the battery. These units also regulate incoming mains voltage before sending it onto your gear, adding more protection.StandbyStand-by units are similar to Line Interactive but do not pre-process/smooth over changes in voltage. They simply switch to battery if a change is detected, whereas line-interactive will process to a degree before switching to battery. As such, these units will burn through batteries quickly.OutroThat will conclude for this section of the post. I tried to keep this section focused on the physical, expensive compute gear needed. The next section will be focused more on “odds and ends” such as dedicated write blockers, mobile gear, and various adapters and accessories that might come in handy.*Disclaimer: I’m not sponsored by any of the companies mentioned above, nor do they know (well I don’t think they know) that I’ve written this.Edit: 22 August 2022 - added a short section about UPSs" }, { "title": "Forensics Laboratory - The Building Blocks - Physical Location", "url": "/posts/forensic-laboratory-the-building-blocks-physical-location/", "categories": "", "tags": "laboratory, infrastructure", "date": "2022-08-14 15:25:19 -0700", "snippet": "IntroductionHiya!This is the beginning of a series of posts detailing my lovely experience of building up a new Forensics Laboratory(Lab) for $lastjob. I was put in the unique position to (partially) design and manage the construction of the new facility, and move all our infrastructure over while adding to the backbone and other infrastructure we had previously. As some background, I was managing this facility due to the prior lab manager leaving, and I, while not terribly close to the facility, had spent the most time in forensic labs, including that one, to anyone local, and was thus delegated to managing that facility. The move was not something I had ever planned to take on, but corporate changes with the building required a new facility to be built. Most of what was in the old facility, in terms of both setup, logic, and physical infrastructure, was all tribal knowledge, so alongside the planning/building/move, it was critical to actually document why things were done in such a way for anyone else who took over after me.Additionally, we also had the FBI CJIS audit and ISO 27001/27002 audit and attestation to contend with. Both have extremely similar, if not identical compliance requirements for most items, however, FBI CJIS is what let us work with local/state/federal governments on various cases if need be. The CJIS audit also comes with the lovely reminder that if the evidence is mishandled, the data custodian gets time in a comfy cell!A lot of this information is based on this lovely book here: Digital Forensics Processing and Procedures: Meeting the Requirements of ISO 17020, ISO 17025, ISO 27001 and Best Practice Requirements and Building a Digital Forensic Laboratory, which was recommended to me by my former co-worker/mentor(thanks J.W!) who has a hell of a lot more experience with this stuff, and who guided me through the finer points of the entire process.Physical LocationI suppose the obvious comes first- the actual location and general access rules of the lab itself. Not anyone can walk into the lab willy-nilly, let alone the building itself. A low-key area, one wholly owned and operated by the company tends to be ideal. All of the usual physical security steps apply to both the building and the lab. Employees must have at bare minimum a badge to enter the building, and ideally some sort of ‘2FA’ factor, such as the ones listed below: PIN code Fingerprint Retinal Scan A combination of the above So on and so forthYou can get even crazier with this such as using a gait scanner, although I don’t think many go to that degree. If possible, I would recommend a combination of PIN + biometrics. While just having the badge and one of the above is enough, it never hurts to have more steps and to annoy anyone trying to enter. These requirements solve the ‘something you have and ‘something you are requirements.Additionally, a man-trap is ideal to have at the entrance to the building itself. After that, the lab itself must have ‘2FA’ for entry. Only allowed personnel can badge into the lab. Exceptions can be made, eg for maintenance/cleaning, if the lab manager or other authorized personnel can be on-site and monitor others in the room. Such occurrences should be kept to a minimum, but I definitely know the pain of having to travel to the site due to a burst pipe or faulty air conditioning system, and occurrences like that are seldom planned for.Only the Lab Manager and Consulting Director at my last job were the ones allowed to add people to the access list for the lab. While the command structure may be different at your job, I HIGHLY recommend doing a few items when adding or removing people from the access list, or even other lab changes: Have a minimum of two people sign off on the addition/removal of personnel Ideally this would be the Lab Manager and their supervisor, but that can vary Create a change form and seek approval This form detailed changes made, who requested the change, peer reviewers, and the final approval The final approver in our case was the Global Director of ProServ, but titles change. In other words, my boss’s boss. This changed form was something I inherited as part of the CJIS audit, however, we quickly utilized it for any physical/logical changes in regards to the physical lab itself. Cameras should also be monitoring the lab area as well as points of ingress and egress. We logged all motion activity and kept entrance/exit logs of both the card readers and motion for some time (eg one year) for compliance reasons - this includes all successful and failed attempts to badge in, and motion activity as detected by the cameras. The company’s security team also had alerts for this room treated as a priority above all others to verify the person entering. Essentially, we did our best to turn this room into a SCIF.For the new location, we were able to segregate the lab into two rooms: Forensic Machines Evidence and InfrastructureThe primary room housed our forensic machines and basic supplies, adapters, etc. Anyone on the ProServ team was allowed into this room. The second room housed evidence safes and servers. Only the Lab Manager and Data Custodians were allowed into this room.Additional Considerations for Physical LocationAside from the access requirements above, we also added several extras that aren’t entirely required but are helpful.Both rooms had anti-static flooring, which was linked to grounding straps throughout the room. This was a good addition to a room where sensitive electronics(evidence) would be handled. We also had security mesh installed throughout the walls/floors/ceilings of the room. This is essentially mesh made of some alloy that prevents people from bashing through the walls, or slows down access if someone attempts to cut through with an angle grinder or plasma cutter. This, in my mind, is the coolest thing by far done to the room, even if it’s hard enough to get access to the building alone.Each room also had its own HVAC system, separate from house air. As much as I’d like to claim this was for security reasons to prevent toxins from entering the room, it’s simply what’s needed to keep all the equipment in the room at cold temperatures. We set the rooms to 69°F(I promise I’m an adult), and obviously that can be adjusted a tad to personal preference. We did have beefier air filters(four-inch MERV 13 if I recall correctly) to keep dust to an absolute minimum, which we combined with weekly cleanings.If I had another go, I would have also requested mass-loaded vinyl or layers of drywall with green glue in between to be installed in the walls/ceiling/floor to prevent noise from escaping the room, eg if there is a client call with sensitive information going on. While we did add more insulation than normal, and voices are hard to make out, it made sense to me after the fact, something I gathered from adding mass-loaded vinyl inside my car to reduce road noise.The lighting in the room was also brighter than what was installed elsewhere, to allow for easier reading of the tiny serial numbers on hard drives or M.2 SSDS.OutroIn my mind, that constitutes the absolute bare bones building block to start building a lab. The next blog post should be about the actual equipment we used for day-to-day work." } ]
